# 1.了解x86的特权模式

两个难点：特权级，x86内存管理单元

注意两点：程序要保护起来、普通程序不能简单访问os的空间

然后要了解mmu的工作过程

## 特权级

有几个特权级 用户？内核？ 切换？

x86有0 1 2 3四个特权级 0是内核最高特权级 一般程序放在3

一些指令只能在0特权级运行 cpu在很多情况下会做特权级检查

段选择子：在段寄存器里面，其中程序运行需要代码和数据，分别访问程序段和数据段

PRL(requested privilege level) CPL一个位于数据段，一个位于代码段 合在一起 与dpl进行比较

RPL在DS ES FS GS中 

CPL在CS SS中

访问的时候，有两个特权级，第一个就是后两位的CPL，代表当前所在数据段的优先级；RPL说明要访问的数据的优先级

DPL是描述要访问段的优先级

中断陷入异常：门情况？**没太看懂 什么叫？cpl<=DPL[门]**

访问段时的情况...

# 2.了解特权级的切换

ucore中使用中断来实现切换

什么是中断？其实会有一个中断门，然后通过中断描述符表进行跳转。

如何从0->3？：ring0产生中断，会将一些信息压栈。->会将cs中的cpl改成3，模仿ring3的形式进行修改，**这是在哪里转换的呢？**->iret指令执行以后，就会将信息弹出

如何从3->到0？：软中断，同样是在堆栈里面做修改->让其符合形式，->然后iret指令便可以让信息返回

就是切换特权级以后，是如何知道他们的地址、堆栈呢？用一个全局的TSS进行保存

访问TSS，需要使用全局描述符表，在pmm.c中建立tss

# 3.了解段页表

